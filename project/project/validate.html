<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="./css/datepicker.css">
    <title>validate</title>
</head>
<style>
.left_text {
    width: 70%;
    float: left;
}

.left_text table thead td {
    vertical-align: top;
    line-height: 30px;
}

input {
    -webkit-appearance: none;
}

ul,
li,
ol {
    list-style: none;
    list-style-type: none;
}

body,
div,
ul,
li,
p,
span,
h1,
h2,
h3,
h4,
h5,
h6,
img,
form,
table,
tr,
td,
dl,
dt,
dd,
input,
select {
    margin: 0;
    padding: 0;
}

.hide {
    display: none;
}

.clear {
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    font-size: 0;
    list-style: none;
    list-style-type: none;
    clear: both;
    zoom: 1;
}

.formdiv {
    width: 400px;
    margin: 0 auto;
}

.myform {
    width: 100%
}

.myform ul li {
    width: 100%;
    line-height: 20px;
    margin-bottom: 24px;
    text-align: center;
    position: relative;
}

.myform span {
    width: 35%;
    line-height: 40px;
    font-size: 16px;
    text-align: right;
    display: inline-block;
    vertical-align: top;
}

.myform input,
.myform select {
    width: 62%;
    height: 40px;
    line-height: 40px;
    text-align: left;
    text-indent: 4px;
    display: inline-block;
    outline: none;
    border: 1px solid #ddd;
}

.myform textarea {
    width: 60%;
    height: 100px;
    line-height: 20px;
    text-align: left;
    display: inline-block;
    outline: none;
    border: 1px solid #ddd;
}






/*.myform .error:not(input){width:100%;text-align:center;display:inline-block;line-height: 20px;margin-bottom: 10px;}
    .myform textarea.error{width: 62%;}
    .myform .error{color:red;}
    input.error,textarea.error,.myform input[type="checkbox"].error +label:after{
    border:1px solid red;}*/

.myerror span {
    color: red;
    display: block;
}

.focuserror {
    border: 1px solid red;
}

.myform .btn {
    width: 140px;
    height: 40px;
    line-height: 40px;
    background: #00adee;
    text-align: center;
    margin: 0 auto;
    color: #fff;
    font-size: 20px;
    border: none;
}

.myform .agree {
    width: 66%;
    line-height: 30px;
    text-align: center;
    float: none;
    margin: 0 auto;
    display: inline-block;
}






/*.myform .agree:before {
    content: "\26AB";
    color: #ddd;
    width: 24px;
    height: 24px;
    border: 1px solid #ccc;
    margin-right: 10px;
    display: inline-block;
    font-size: 0;
    text-align: center;
    line-height: 24px;
    vertical-align: middle;
    transition: color ease .3s;
}

.myform input[type="checkbox"]:checked+label:before {
    font-size: 14px;
}*/

.agree .checkgagree {
    display: inline-block;
    width: 24px;
    height: 24px;
    background: url(./images/m_09.png) no-repeat center;
    vertical-align: middle;
}

.agree .checkgagree.on {
    background: url(./images/m_08.png) no-repeat center;
}

.myform p.msg {
    position: absolute;
    bottom: -20px;
    left: 35%;
    font-size: 13px;
    margin-left: 24px;
    color: red;
    line-height: 18px;
    text-align: left;
    vertical-align: middle;
    background: url(./images/warning.png) no-repeat left center;
    text-indent: 20px;
}






/*.myform input.msg{border: 1px solid red;}*/


/*.myform p.msg:before {
    position: absolute;
    content: '!';
    border-radius: 100%;
    background-color: red;
    color: #fff;
    top: 2px;
    left: -15px;
    width: 14px;
    height: 14px;
    text-align: center;
    font-size: 12px;
    font-weight: bold;
    line-height: 14px;
}*/

.myform p.msg i {
    display: inline-block;

    width: 18px;
    height: 18px;
    vertical-align: top;
}

#agree-error {
    top: 8px;
    left: 86%;
    margin-left: 0;
}

.choose {
    display: inline-block;
    vertical-align: top;
    width: 62%;
    max-width: 512px;
    text-align: left;
}

.choose i {
    display: inline-block;
    width: 18px;
    height: 18px;
    vertical-align: middle;
}

.choose span {
    display: inline-block;
    vertical-align: middle;
    width: auto;
}

.singleSelected i {
    background: url(./images/m_06.png) no-repeat center;
}

.singleSelected li.on i {
    background: url(./images/m_07.png) no-repeat center;
}

.moreSelected i {
    background: url(./images/m_09.png) no-repeat center;
}

.moreSelected li.on i {
    background: url(./images/m_08.png) no-repeat center;
}

.moreSelected i.noclick {
    background: url(./images/m_11.png) no-repeat center;
}

.myform .choose li {
    margin-right: 10px;
    display: inline-block;
    width: auto;
    margin-bottom: 10px;
}

.infolength {
    position: absolute;
    right: 10px;
    bottom: 4px;
    font-style: normal;
}

.overMax {
    color: red;
}

.myform input.haserror,
.myform select.haserror {
    border: 1px solid red;
}






/*myform2*/

.myform2 p.msg {
    position: static;
    display: block;
    visibility: hidden;
    margin-left: 37%;
}

.myform2 ul li {
    margin-bottom: 0;
}
</style>

<body>
    <div class="formdiv form1">
        <form class="myform" id="form1" method="post" action="">
            <ul>
                <li>
                    <span for="cname">姓名</span>
                    <input id="cname" name="name" minlength="2" type="text" required>
                </li>
                <li>
                    <span for="phone">电话</span>
                    <input id="cphone" name="phone" type="text">
                </li>
                <li>
                    <span for="file">image</span>
                    <input id="file" name="file" type="file" required>
                </li>
                <li>
                    <span for="cemail">E-Mail</span>
                    <input id="cemail" type="email" name="email" required>
                </li>
                <li>
                    <span for="password">密码</span>
                    <input id="password" name="password" type="password">
                </li>
                <li>
                    <span for="confirm_password">确认密码</span>
                    <input id="confirm_password" name="confirm_password" type="password">
                </li>
                <li>
                    <span for="curl">URL</span>
                    <input id="curl" type="url" name="url">
                </li>
                <li>
                    <span for="ccomment">内容</span>
                    <textarea id="ccomment" name="comment"></textarea>
                    <i class="infolength">0/30</i>
                </li>
                <li>
                    <span for="total">总人数</span>
                    <input id="total" type="number" name="total">
                </li>
                <li>
                    <span for="part">干部人数</span>
                    <input id="part" type="number" name="part"></input>
                </li>
                <li>
                    <span for="ccomment">价格</span>
                    <input id="price" name="price" type="number"></input>
                </li>
                <!-- <label for="agree"></label> -->
                <li>
                    <span>选择</span>
                    <select name="selectvalue" required title='请选择阿'>
                        <option value="">请选择</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                    </select>
                </li>
                <li>
                    <span>多选</span>
                    <select name="multselectvalue" required title='至少选择两个' minlength="2" multiple="multiple">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </li>
                <li>
                    <span>单选</span>
                    <div class="choose singleSelected">
                        <ul>
                            <li><i></i> <span>1234</span></li>
                            <li><i></i> <span>2s</span> </li>
                            <li><i></i> <span>3</span> </li>
                            <li><i></i> <span>4</span> </li>
                            <li><i></i> <span>5</span> </li>
                            <li><i></i> <span>6</span> </li>
                            <li><i></i> <span>7</span> </li>
                        </ul>
                    </div>
                    <input type="hidden" name="singleSelectInput" required>
                </li>
                <li>
                    <span>多选</span>
                    <div class="choose moreSelected">
                        <ul>
                            <li><i></i> <span>1234</span></li>
                            <li><i class='noclick'></i> <span>2s</span> </li>
                            <li><i></i> <span>3</span> </li>
                            <li><i></i> <span>4</span> </li>
                            <li><i></i> <span>5</span> </li>
                            <li><i></i> <span>6</span> </li>
                            <li><i></i> <span>7</span> </li>
                        </ul>
                    </div>
                    <input type="hidden" name="moreSelectInput" required>
                </li>
                <li>
                    <span>开始时间：</span>
                    <input id="repay_start_time" name="repay_start_time" type="text" class="datepicker2" readonly="true" required />
                </li>
                <li>
                    <span>截止时间：</span>
                    <input id="repay_end_time" name="repay_end_time" type="text" class="datepicker2" readonly="true" required/>
                </li>
                <li>
                    <span>预计使用天数：</span>
                    <input id="repay_period" name="repay_period" type="text" readonly class="repay_period" />
                </li>
                <li>
                    <input type="checkbox" class="checkbox" id="agree" name="agree" style="display: none;">
                    <label for="agree" class="agree"><i class="checkgagree"></i>Please agree to our policy</label>
                </li>
                <li>
                    <!-- <div class="myerror"><span></span></div> -->
                    <!-- <input class="btn" id="submit" type="button" value="Submit"> -->
                    <div class="btn submit1">submit</div>
                </li>
            </ul>
            <div id='summary'></div>
        </form>
    </div>
    <!-- 错误信息存在于页面 -->
    <div class="formdiv form2">
        <form class="myform myform2" id="form2">
            <ul>
                <li>
                    <span>xx</span>
                    <input type="text" name="form2in1" required>
                    <p class="msg">必填</p>
                </li>
                <li>
                    <span>xx</span>
                    <input type="text" name="form2in2" required>
                    <p class="msg">必填</p>
                </li>
            </ul>
            <div class="btn submit2">submit</div>
        </form>
    </div>
    <!-- 自定义验证 -->
    <div class="formdiv form3">
        <form class="myform myform3" id="form3">
            <ul>
                <li>
                    <span>小数点保留n位：</span>
                    <input type="number" name="form3in1" required decimal="3">
                </li>
                <li>
                    <span>传真：</span>
                    <input type="text" name="form3in2" required isFax="true">
                </li>
                <li>
                    <span>价格(正数，保留2位小数，不带+)：</span>
                    <input type="text" name="form3in3" required isPrice2="true">
                </li>
                <li>
                    <span>价格(可带+,自定义保留几位小数)：</span>
                    <input type="text" name="form3in4" required isPrice="4">
                    <!-- month="true" -->
                </li>
                <li>
                    <span>人数(正整数)：</span>
                    <input type="text" name="form3in5" required digits="true">
                </li>
                <li>
                    <span>月份(1-12)：</span>
                    <input type="text" name="form3in6" required range="[1,12]" digits="true">
                    <!-- month="true" -->
                </li>
                <li>
                    <span>利润：</span>
                    <input type="number" name="form3in7" required decimal="2">
                </li>
            </ul>
            <div class="btn submit3">submit</div>
        </form>
    </div>
    <script src="js/jquery.js"></script>
    <script src="js/jquery.validate.js"></script>
    <script src="js/datepicker.js"></script>
    <script>
    (function($) {
        $.extend($.validator.messages, {
            required: "必填项",
            remote: "请修正该信息",
            email: "请输入正确格式的电子邮件",
            url: "请输入合法的网址",
            date: "请输入合法的日期",
            dateISO: "请输入合法的日期 (ISO).",
            number: "请输入合法的数字",
            digits: "只能输入整数",
            creditcard: "请输入合法的信用卡号",
            equalTo: "请再次输入相同的值",
            accept: "请输入拥有合法后缀名的字符串",
            maxlength: $.validator.format("请输入一个长度最多是 {0} 的字符串"),
            minlength: $.validator.format("请输入一个长度最少是 {0} 的字符串"),
            rangelength: $.validator.format("请输入一个长度介于 {0} 和 {1} 之间的字符串"),
            range: $.validator.format("请输入一个介于 {0} 和 {1} 之间的值"),
            max: $.validator.format("请输入一个最大为 {0} 的值"),
            min: $.validator.format("请输入一个最小为 {0} 的值"),

        });
    }(jQuery));
    </script>
    <script>
    //this.optional(element)判断element是否是可选的，也就是是否指定了required
    /*保留n位小数,可正可负,默认保留2位*/
    jQuery.validator.addMethod("decimal", function(value, element, params) {
        var returnVal = true;
        inputZ = value;
        var ArrMen = inputZ.split("."); //截取字符串
        if (ArrMen.length == 2) {
            if (ArrMen[1].length > params) { //判断小数点后面的字符串长度
                returnVal = false;
                return false;
            }
        }
        return this.optional(element) || returnVal;
    }, $.validator.format("保留{0}位小数"));
    /*传真*/
    jQuery.validator.addMethod("isFax", function(value, element) {
        return this.optional(element) || /^((\(\d{2,3}\))|(\d{3}\-))?(\(0\d{2,3}\)|0\d{2,3}-)?[1-9]\d{6,7}(\-\d{1,4})?$/i.test(value);
    }, "传真号码错误");

    /*$.validator.setDefaults({
                        submitHandler: function() {
                           alert("提交成功!");
                        }
                });*/
    /*自定义验证*/
    /* addMethod 的第一个参数,就是添加的验证方法的名子,这时是af
     * addMethod 的第三个参数,就是自定义的错误提示,这里的提示为:”必须是一个字母,且a-f”
     * addMethod 的第二个参数,是一个函数,这个比较重要,决定了用这个验证方法时的写法，
        第一个：value ，是当前验证的元素的值。
        第二个： element  是当前被验证的元素。
        第三个：是传入的参数，例如:min:5这个参数为5
     */

    /*验证只针对于name属性，且name属性相同时，只验证第一个*/
    $.validator.addMethod('af', function(value, element, params) {
        if (value.length > 1) {
            return false;
        }
        if (value >= params[0] && value <= params[1]) {
            return true;
        } else {
            return false;
        }
    }, '必须是一个字母, 且a - f');
    //验证正整数(可以有+)
    jQuery.validator.addMethod("posinteger", function(value, element) {

        var tel = /^[+]{0,1}(\d+)$/g;

        return this.optional(element) || (tel.test(value));

    }, "请输入正整数");
    /*验证输入的是非负数，带小数点，可验证价格*/
    jQuery.validator.addMethod("isPrice", function(value, element, params) {
        var reg = "^[+]{0,1}(\\d+)$|^[+]{0,1}(\\d+\.\\d{0," + params + "})$";
        var regExp = new RegExp(reg, "g");
        return this.optional(element) || (regExp.test(value));

    }, $.validator.format("价格出错(保留{0}位小数)"));
    // 验证输入数字是1-12
    //range="[1,12]" digits="true"
    jQuery.validator.addMethod("month", function(value, element) {

        var tel = /^([1-9]|1[0-2])$/g;

        return this.optional(element) || (tel.test(value));

    }, "1-12月份");

    /*自定义验证：价格：小数点最多输入两位*/
    jQuery.validator.addMethod("isPrice2", function(value, element) {
        var price = /^\d*\.{0,1}\d{0,2}$/g;

        return this.optional(element) || (price.test(value));

    }, "正数且小数点后最多为两位"); //验证错误信息

    /*验证两个输入吗，其中一个输入小于另一个输入,eg:输入优惠金额要小于总金额*/
    jQuery.validator.addMethod("lessTotal", function(value, element) {
        var returnVal = true;
        var total = $('input[name="total"]').val(),
            diff = total - value;
        if (diff < 0) {
            /*console.log(diff)*/
            returnVal = false;
        }
        /*console.log(returnVal);*/
        return this.optional(element) || returnVal;
    }, "小于总人数");

    /*自定义验证，优惠值小于总计金额*/
    /*jQuery.validator.addMethod("lessTotal",function(value, element){
            var returnVal =true;
            var obj = $(".rig-bot_wrapp ul").children(".total_price").clone();
            obj.find(':nth-child(n)').remove();       
            var deathline = obj.html().replace(/￥/g, '').trim();
            

            if(parseFloat(value)>parseFloat(deathline)){
                returnVal = false;
            }
            
            return returnVal;
        },"请输入正确的优惠值");*/

    /****************************************************/
    //随机数组
    /*$rand_arr = [];
    for (var i = 0; i < 20; i++) {
        $rand_arr.push(i + 1);
    }*/
    /*增加*/
    /*$(document).on('click', '.add2', function() {

        var a = $('.addedTmpl .mb').html();
        var num = $rand_arr[0];

        $('.new').append(a);
        $('.new tr:last .addinput0').attr('name', 'addinput[' + num + '][0]');
        $('.new tr:last .addinput1').attr('name', 'addinput[' + num + '][1]').rules("add", { isPrice:true,min:0});
        $('.new tr:last .addinput2').attr('name', 'addinput[' + num + '][2]').rules("add", { min:1 ,digits:true,messages:{digits:"输入正整数"}});
        $rand_arr.shift();
        prod_autocomplete();
    });*/
    /****************************************************/
    </script>
    <script>
    //js计算，保留n位小数
    function round2(number, fractiondigits) {
        return Math.round(number * Math.pow(10, fractiondigits)) / Math.pow(10, fractiondigits);
    }
    $(function() {
        //form1
        var form1 = $("#form1").validate({
            //如果为true，当表单得到焦点时，移除在该表单上的errorClass并隐藏所有错误消息。避免与focusInvalid一起使用。
            //focusCleanup: true,
            //错误消息统一存放的容器
            //errorLabelContainer: $("#form1 .myerror>span"),
            // wrapper: 'span', //指定使用什么标签再把上边的 errorELement 包起来
            errorElement: "p",
            errorClass: "msg",
            rules: {

                phone: {
                    required: true,
                    isPhone: true
                },
                // , file: { fileType: { types: ["jpg", "jpeg", "png"] }, maxFileSize: { "unit": "MB", "size": 1 } }
                agree: { required: true },
                password: {
                    required: true,
                    minlength: 5
                },
                confirm_password: {
                    required: true,
                    minlength: 5,
                    equalTo: "#password"
                },
                price: {
                    required: true,
                    number: true,
                    isPrice: true
                },
                total: {
                    required: true,
                    min: 1
                },
                part: { lessTotal: true },
                comment: { minlength: 10, maxlength: 30 }
            },
            messages: {
                name: { minlength: '姓名至少两个字符串' },
                phone: '请输入正确的手机号',
                email: '请输入正确的Email',
                comment: '请输入评论',
                agree: { required: "请勾选" },
                recordcompanytype: { required: '请选择' }

            },
            //ignore:当进行表单验证时，过滤掉选择器所选择的表单。用了jQuery not方法（ not() ）。类型为submit和reset的表单总是被忽略的。 
            ignore: "not:hidden",

            //invalidHandler:当未通过验证的表单提交时，可以在该回调函数中处理一些事情。该回调函数有两个参数：第一个为一个事件对象，第二个为验证器（validator） 
            invalidHandler: function(form, validator) {
                $(form.currentTarget).find('p.msg').remove();
                var errors = validator.numberOfInvalids();
                // alert(validator.errorList[0].message);
                // $('.myerror span').html(validator.errorList[0].message);
                // $('.myerror').show();

                var el = $(validator.errorList[0].element),
                    li = el.parent('li');
                el.focus(); //光标显示在第一个出错的地方
                // console.log(li.html());
                //验证出错时滚动到初始错误处，用于页面过长
                if (el.offset().top < $(window).scrollTop()) {
                    $('html,body').animate({
                        scrollTop: (li.offset().top - 84) + 'px'
                    }, 300);
                }
            },
            //可以显示总共有多少个未通过验证的元素
            showErrors: function(errorMap, errorList) {
                $("#summary").html("Your form contains " + this.numberOfInvalids() + " errors,see details below.");
                this.defaultShowErrors();
            },
            //errorPlacement: Override error placement to not show error messages beside elements 
            errorPlacement: function(error, element) {
                //显示第一个，验证创建的代码,通过name唯一性判断
                var firstErrEle = $(form1.errorList[0].element).attr('name'),
                    nowErrEle = $(element).attr('name');
                if (firstErrEle == nowErrEle) {
                    // console.log(firstErrEle,nowErrEle);
                    var li = element.parent('li');
                    console.log(error);
                    // error.prepend('<i></i>');
                    error.appendTo(li);
                }


                // var el = $(form1.errorList[0].element);
                // console.log(el);
                // var li = el.parent('li');
                // error.insertAfter(li);

                //错误代码放置在元素后面（全部显示）
                // error.insertAfter(element);
                //在此滚动到错误位置需加判断
                // if (el.offset().top<$(window).scrollTop()) {
                //     $('html,body').animate({
                //         scrollTop: (li.offset().top - 200) + 'px'
                //     }, 100);
                // }
            },
            //submitHandler:当表单通过验证，提交表单。回调函数有个默认参数form 
            submitHandler: function() {
                // alert("提交成功!");
            },
            onclick: function(element, event) { //可验证select
                $(element).valid();
            },
            //失去交时执行
            onfocusout: function(element, event) {
                $(element).valid();
                // var el = $(element),
                //     msg = el.parent("li").find('.msg'),
                //     errors = form1.numberOfInvalids();
                // if (el.is(':input') && !el.is(':password')) {
                //     el.val($.trim(el.val()));
                // }

                // console.log();
                // if (el.valid()) {
                //     msg.hide();
                // }
            },
            //键盘输入时执行
            onkeyup: function(element) {
                // var el = $(element),
                //     li = el.parent('li');
                // el.valid();
                // if (form1.errorList.length == 0) {
                //     li.find('.msg').hide();
                // }
                $(element).valid();
            }
            //highlight:将未通过验证的表单元素设置高亮。 
            // highlight: function(element, errorClass) {
            //    console.log(errorClass);
            //     $(element).fadeOut(function() {
            //         $(element).fadeIn()
            //     })
            // }
        });
        $(document).on('click', '.submit1', function() {
            if (!$("#form1").valid()) {
                return;
            }
            alert('success');
        });
        //form2
        var form2 = $("#form2").validate({
            rules: {
                /*amount: { integer: true },
                loan_rate: { integer: true },
                standard_rate: { integer: true },
                period: { max: 1096, min: 0 }*/

            },
            ignore: "not:hidden",
            onclick: function(element) {
                var el = $(element),
                    li = el.parent('li');
                if (el.valid()) {
                    li.children('.msg').css("visibility", "hidden");
                }
            },
            onfocus: function(element) {
                console.log(element);
                var el = $(element),
                    li = el.parent('li');
                if (el.valid()) {
                    li.children('.msg').css("visibility", "hidden");
                }
            },
            onfocusout: function(element) {
                var el = $(element),
                    li = el.parent('li');
                if (el.valid()) {
                    li.children('.msg').css("visibility", "hidden");
                }
            },
            onkeyup: function(element) {
                var el = $(element),
                    li = el.parent('li');
                if (el.valid()) {
                    li.children('.msg').css("visibility", "hidden");
                }
            },
            errorPlacement: function(error, element) {
                var el = $(form2.errorList[0].element);
                // var el = $(element);
                var li = el.parent('li');
                element.removeClass('error');
                el.addClass('error');
                li.children('.msg').css("visibility", "visible");
            },
            invalidHandler: function(form, validator) {
                var errors = validator.numberOfInvalids();
                $('.msg').css("visibility", "hidden");
                var el = $(validator.errorList[0].element); //滚动到第一个错误
                var li = el.parent('li');
                if (el.offset().top < $(window).scrollTop()) { //判断在一屏上则不滚动
                    $('.dcontent').animate({
                        scrollTop: ((li[0].offsetTop) - 100) + 'px'
                    }, 100);
                }

            }
        });
        $(document).on('click', '.submit2', function() {
            if (!$("#form2").valid()) {
                return;
            }
            alert('success');
        });
        //form3
        var form3 = $("#form3").validate({
            //如果为true，当表单得到焦点时，移除在该表单上的errorClass并隐藏所有错误消息。避免与focusInvalid一起使用。
            //focusCleanup: true,
            //错误消息统一存放的容器
            //errorLabelContainer: $("#form1 .myerror>span"),
            // wrapper: 'span', //指定使用什么标签再把上边的 errorELement 包起来
            errorElement: "p",
            errorClass: "msg",
            rules: {},
            messages: {
                // form3in1: { decimal: "保留3位小数" }

            },
            //ignore:当进行表单验证时，过滤掉选择器所选择的表单。用了jQuery not方法（ not() ）。类型为submit和reset的表单总是被忽略的。 
            ignore: "not:hidden",

            //invalidHandler:当未通过验证的表单提交时，可以在该回调函数中处理一些事情。该回调函数有两个参数：第一个为一个事件对象，第二个为验证器（validator） 
            invalidHandler: function(form, validator) {
                $(form.currentTarget).find('p.msg').remove();
                var errors = validator.numberOfInvalids();
                var el = $(validator.errorList[0].element),
                    li = el.parent('li');
                el.focus(); //光标显示在第一个出错的地方
                // console.log(li.html());
                //验证出错时滚动到初始错误处，用于页面过长
                if (el.offset().top < $(window).scrollTop()) {
                    $('html,body').animate({
                        scrollTop: (li.offset().top - 84) + 'px'
                    }, 300);
                }
            },
            //可以显示总共有多少个未通过验证的元素
            /*showErrors: function(errorMap, errorList) {
                $("#summary").html("Your form contains " + this.numberOfInvalids() + " errors,see details below.");
                this.defaultShowErrors();
            },*/
            //errorPlacement: Override error placement to not show error messages beside elements 
            errorPlacement: function(error, element) {
                //显示第一个，验证创建的代码,通过name唯一性判断
                var firstErrEle = $(form3.errorList[0].element).attr('name'),
                    nowErrEle = $(element).attr('name');
                if (firstErrEle == nowErrEle) {
                    // console.log(firstErrEle,nowErrEle);
                    var li = element.parent('li');
                    // console.log(error);
                    // error.prepend('<i></i>');
                    error.appendTo(li);
                }
            },
            //submitHandler:当表单通过验证，提交表单。回调函数有个默认参数form 
            submitHandler: function() {
                // alert("提交成功!");
            },
            onclick: function(element, event) { //可验证select
                $(element).valid();
            },
            //失去交时执行
            onfocusout: function(element, event) {
                $(element).valid();

            },
            //键盘输入时执行
            onkeyup: function(element) {
                $(element).valid();
            }
            //highlight:将未通过验证的表单元素设置高亮。 
            // highlight: function(element, errorClass) {
            //    console.log(errorClass);
            //     $(element).fadeOut(function() {
            //         $(element).fadeIn()
            //     })
            // }
        });
        
        $(document).on('click', '.submit3', function() {
            if (!$("#form3").valid()) {
                return;
            }
            alert('success');
        });
        //日历
        $('#repay_start_time').datepicker({
            dateFormat: 'yy-mm-dd',
            changeYear: true,
            changeMonth: true,
            onSelect: function(dateText, inst) {
                $(this).next('.msg').css("visibility", "hidden");
                $("#repay_end_time").datepicker("option", "minDate", getDay(dateText, 1));
                getperiod('repay_start_time', 'repay_end_time', 'repay_period');
            }
        });
        $('#repay_end_time').datepicker({
            dateFormat: 'yy-mm-dd',
            changeYear: true,
            changeMonth: true,
            onSelect: function(dateText, inst) {
                $("#repay_start_time").datepicker("option", "maxDate", getDay(dateText, -1));
                $(this).next('.msg').css("visibility", "hidden");
                getperiod('repay_start_time', 'repay_end_time', 'repay_period');
            }
        });
        $(document).on('change input', 'textarea', function() {
            var length = $(this).val().length,
                maxlength = 30;
            if (length > maxlength) { $('.infolength').addClass('overMax'); } else { $('.infolength').removeClass('overMax'); }
            $('.infolength').html(length + '/' + maxlength);

        });

        //单选
        $(document).on('click', '.singleSelected li', function() {
            var $el = $(this),
                $I = $el.find('i'),
                index = $el.index(),
                input = $('input[name="singleSelectInput"]'),
                p = $el.parents('li');
            $el.addClass('on').siblings().removeClass('on');
            input.val(index);
            p.find('p.msg').hide();
        });
        //多选
        function getNoclick() {
            var arr = [];
            $('.moreSelected li').each(function() {
                var $el = $(this),
                    $I = $el.find('i');
                if ($I.hasClass("noclick") || $I.hasClass("selectCur")) {
                    arr.push($el.index());
                }
            });
            return arr;
        }
        var arr = getNoclick(),
            input = $('input[name="moreSelectInput"]');
        input.val(arr);
        $(document).on('click', '.moreSelected li', function() {
            var $el = $(this),
                $I = $el.find('i'),
                input = $('input[name="moreSelectInput"]');
            if ($I.hasClass("noclick")) {
                return false;
            }
            $el.toggleClass('on');
            $I.toggleClass('selectCur');
            var arr = getNoclick();
            input.val(arr);
        });
        //勾选同意
        $(document).on('click', '.agree ', function() {
            var $el = $(this),
                $I = $el.find('.checkgagree');
            $I.toggleClass('on');
        });
        //结束时间大于开始时间
        function getDay(d, n) {
            d = new Date(d);
            d = +d + 1000 * 60 * 60 * 24 * n;
            d = new Date(d);
            return d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate();
        }
        //计算预计还款天数
        function DateDiff(sDate1, sDate2) { //sDate1和sDate2是yyyy-MM-dd格式
            var aDate, oDate1, oDate2, iDays;
            aDate = sDate1.split("-");
            oDate1 = new Date(aDate[1] + '-' + aDate[2] + '-' + aDate[0]); //转换为yyyy-MM-dd格式
            aDate = sDate2.split("-");
            oDate2 = new Date(aDate[1] + '-' + aDate[2] + '-' + aDate[0]);
            iDays = parseInt(Math.abs(oDate1 - oDate2) / 1000 / 60 / 60 / 24); //把相差的毫秒数转换为天数
            return iDays;
        }

        function getperiod(s1, s2, s3) {
            var daystart = $('#' + s1).val(),
                dayend = $('#' + s2).val();
            if (daystart == '') { return; }
            if (dayend == "") { return; }
            $('#' + s3).val(DateDiff(daystart, dayend));
        }
    });
    </script>
</body>

</html>
<!-- 
var validator = $(".form_apply").validate({
            rules: {
                amount: { integer: true },
                loan_rate: { isPercent: true },
                standard_rate: { isPercent: true },
                period: { max: 1096, min: 0 }
                loan_rate: { isPercent: true }
            },
            onfocusout: function(element) {
                var el = $(element),
                    li = el.closest('li');
                el.valid();
                if (validator.errorList.length == 0) {
                    li.find('.msg').css("visibility", "hidden");
                };
            },
            onkeyup: function(element) {},
            invalidHandler: function(form, validator) {
                var errors = validator.numberOfInvalids();
                if (errors) {
                    var el = $(validator.errorList[0].element);
                    var li = el.closest('li');
                    li.find('.msg').css("visibility", "visible");
                    var scrollValue = (li.offset().top - 80) + 'px';
                    $('.dcontent').animate({
                        scrollTop: scrollValue
                    }, 100);
                }
            },
            errorPlacement: function(error, element) {
                var el = $(validator.errorList[0].element);
                var li = el.closest('li');
                li.find('.msg').css("visibility", "visible");
            }
        }); 
-->